# 测试用例文档（Test Cases）— OnHit 聚合接口与伤害桶

说明：以下测试聚焦纯逻辑聚合函数与接线次序，不依赖 Minecraft 核心类。

## 覆盖维度
- 百分比同乘区相加后一次性应用
- 平直加伤与百分比的组合顺序
- BYPASS 行为跳过聚合
- 兼容阶段调用顺序与跳重
- 异常/边界输入处理（负值、NaN、∞、超大 flat）

## 用例清单
1) 单一百分比
   - 输入：base=100, percent=[+0.2]
   - 期望：结果=120

2) 多百分比相加
   - 输入：base=100, percent=[+0.2, +0.3]
   - 期望：结果=150（而非 156）

3) 百分比 + 平直
   - 输入：base=100, percent=[+0.2], flat=+30
   - 期望：结果=150

4) 无贡献（空集合）
   - 输入：base=100
   - 期望：结果=100

5) BYPASS 标签
   - 输入：source 含 BYPASS，base=100, percent/flat 任意
   - 期望：聚合不触发，结果=100

6) 兼容阶段存在未迁移监听器
   - 输入：聚合阶段产生 +0.2；兼容阶段旧监听器将 damage+=10
   - 期望：结果= (100*1.2) + 10 = 130

7) 已迁移监听器跳重
   - 输入：监听器既是贡献者又存在旧实现
   - 期望：兼容阶段跳过该旧实现，不重复增伤

8) 负值/NaN/∞
   - 输入：percent 或 flat 中出现异常值
   - 期望：按 0 处理并发出一次性告警；结果不为 NaN 且 >=0

