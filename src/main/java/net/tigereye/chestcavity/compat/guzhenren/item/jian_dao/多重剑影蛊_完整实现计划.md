# å¤šé‡å‰‘å½±è›Š - å®Œæ•´å®ç°è®¡åˆ’

## æ–‡æ¡£å…ƒä¿¡æ¯
- **åˆ›å»ºæ—¥æœŸ**: 2025-11-14
- **éœ€æ±‚æ¥æº**: å‰‘é“è›Šè™«ç³»ç»Ÿæ‰©å±•
- **å¤æ‚åº¦è¯„çº§**: â­â­â­â­â­ (é«˜åº¦å¤æ‚)
- **ä¼°è®¡å·¥ä½œé‡**: 3-5ä¸ªå¼€å‘å‘¨æœŸ

---

## ä¸€ã€éœ€æ±‚åˆ†æ

### 1.1 æ ¸å¿ƒåŠŸèƒ½
**å¤šé‡å‰‘å½±è›Š** (`item.guzhenren.duochongjianying`)
- **ä¸»åŠ¨æŠ€èƒ½**: è™šå®äº¤é”‹ - å¬å”¤/å¬å›ä¸€åå½±ä¹‹åˆ†èº«ååŠ©æˆ˜æ–—
- **åˆ†èº«ç‰¹æ€§**:
  - å¤åˆ¶ç©å®¶çš®è‚¤ï¼ˆé€šè¿‡ `SkinResolver`ï¼‰
  - æ‹¥æœ‰ç©å®¶ä½ä¸€ä¸ªè½¬æ•°çš„å¢ƒç•Œï¼ˆæœ€ä½1è½¬1é˜¶æ®µï¼‰
  - å­˜å‚¨èƒ¸è…”æ•°æ®ï¼ˆ`ChestCavitySnapshot`ï¼‰
  - å¥—ç”¨è›Šå¸ˆAIï¼ˆæ¥è‡ªè›ŠçœŸäººæ¨¡ç»„ï¼‰
  - æ‹¥æœ‰6+1æ ¼ç‰©å“æ ç•Œé¢

### 1.2 åˆ†èº«å®ä½“è¦æ±‚
#### æŒä¹…åŒ–ç‰¹æ€§
- ç©å®¶ç¦»çº¿ååˆ†èº«ä»å­˜åœ¨ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰
- æ”¯æŒå¬å›æœºåˆ¶ï¼ˆå­˜å‚¨åˆ°ç‰©å“NBTï¼‰
- è·¨ç»´åº¦ä¼ é€è·Ÿéš

#### æˆ˜æ–—èƒ½åŠ›
- **6æ ¼è›Šè™«æ§½ä½**: ç»‘å®š ItemHandlerï¼Œç”¨äºé‡Šæ”¾æŠ€èƒ½
- **1æ ¼å¢ç›Šæ§½ä½**: æ”¾å…¥ç‰©å“æå‡/å‡å°‘åˆ†èº«æ•°æ®ï¼ˆé€šè¿‡ Registry é…ç½®ï¼‰
- ä½¿ç”¨è›Šå¸ˆAIç³»ç»Ÿï¼ˆåŸºäº `GuShiGuChong1Procedure` ç­‰ï¼‰
- èµ„æºç³»ç»Ÿï¼šçœŸå…ƒã€ç²¾åŠ›ã€é­‚é­„ï¼ˆé€šè¿‡ `GuzhenrenResourceBridge`ï¼‰

#### ç•Œé¢äº¤äº’
- **Shift + å³é”®** æ‰“å¼€ 6+1 æ ¼ç•Œé¢
- æ”¯æŒè›Šè™«æ”¾å…¥/å–å‡º
- æ”¯æŒå¢ç›Šç‰©å“é…ç½®
- è¢«å·é“è›Šè™«å·èµ°æ—¶ç›¸åº”æ‰£é™¤

### 1.3 æŠ€æœ¯çº¦æŸ
- **é€šç”¨åŒ–è®¾è®¡**: åˆ†èº«å®ä½“ä¸è€¦åˆå¤šé‡å‰‘å½±è›Šï¼Œå¯ä¾›å…¶ä»–é“ç±»å¤ç”¨
- **SOLIDåŸåˆ™**: å•ä¸€èŒè´£ã€å¼€æ”¾å°é—­ã€ä¾èµ–å€’ç½®
- **KISS/DRY/YAGNI**: é¿å…è¿‡åº¦è®¾è®¡ï¼Œåªå®ç°å½“å‰éœ€æ±‚
- **æœåŠ¡ç«¯/å®¢æˆ·ç«¯åŒæ­¥**: çš®è‚¤ã€NBTã€ç•Œé¢çŠ¶æ€

---

## äºŒã€æ¶æ„è®¾è®¡å†³ç­–

### 2.1 æ–¹æ¡ˆé€‰æ‹©ï¼šåˆ†å±‚æ¶æ„ï¼ˆæ–¹æ¡ˆCï¼‰

**å†³ç­–ç†ç”±**:
1. **ä¿ç•™ç°æœ‰ `SwordShadowClone`**: ç”¨äºçŸ­æœŸä¸´æ—¶åˆ†èº«ï¼ˆå¦‚å‰‘å½±è›Šçš„ç¬æ—¶æ”»å‡»ï¼‰
2. **æ–°å»º `PersistentGuCultivatorClone`**: ä¸“ç”¨äºæŒä¹…åŒ–åˆ†èº«ï¼ˆå¤šé‡å‰‘å½±è›Šï¼‰
3. **è§£è€¦è®¾è®¡**: å¤šé‡å‰‘å½±è›Šåªæ˜¯è¯¥å®ä½“çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯ï¼Œæœªæ¥å¯æ‰©å±•åˆ°å…¶ä»–é“ç±»

**æ¶æ„å›¾**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å¤šé‡å‰‘å½±è›Šï¼ˆä½¿ç”¨æ–¹ï¼‰                    â”‚
â”‚  DuochongjianyingGuItem                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ ä¾èµ–ï¼ˆåˆ›å»º/ç®¡ç†ï¼‰
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      é€šç”¨æŒä¹…åŒ–åˆ†èº«å®ä½“å±‚                        â”‚
â”‚  PersistentGuCultivatorClone                    â”‚
â”‚  - å¢ƒç•Œç³»ç»Ÿ (Tier/Stage)                        â”‚
â”‚  - èµ„æºç³»ç»Ÿ (çœŸå…ƒ/ç²¾åŠ›/é­‚é­„)                     â”‚
â”‚  - èƒ¸è…”æ•°æ®å­˜å‚¨ (ChestCavitySnapshot)           â”‚
â”‚  - 6+1æ ¼ç‰©å“æ  (ItemHandler + å¢ç›Šæ§½)           â”‚
â”‚  - è›Šå¸ˆAIé›†æˆ                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ ä¾èµ–
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åŸºç¡€è®¾æ–½å±‚                             â”‚
â”‚  - GuzhenrenResourceBridge (èµ„æºè®¿é—®)           â”‚
â”‚  - GuCultivatorPersistentUtil (å¢ƒç•Œå·¥å…·)        â”‚
â”‚  - SkinResolver (çš®è‚¤ç³»ç»Ÿ)                      â”‚
â”‚  - ChestCavitySnapshot (èƒ¸è…”æ•°æ®)               â”‚
â”‚  - è›Šå¸ˆAI Procedures (åç¼–è¯‘ä»£ç )               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ä¸ç°æœ‰ä»£ç çš„å…³ç³»

**å¤ç”¨å·²æœ‰ç³»ç»Ÿ**:
- âœ… `SpawnHostileGuCultivatorAction` çš„è£…å¤‡è›Šè™«é€»è¾‘
- âœ… `GuCultivatorPersistentUtil` çš„å¢ƒç•ŒæŒä¹…åŒ–
- âœ… `SkinResolver` çš„çš®è‚¤å¤åˆ¶
- âœ… `ChestCavitySnapshot` çš„èƒ¸è…”æ•°æ®ç®¡ç†
- âœ… è›ŠçœŸäººæ¨¡ç»„çš„ AI Procedures

**æ–°å¢ç³»ç»Ÿ**:
- ğŸ†• æŒä¹…åŒ–åˆ†èº«å®ä½“ç±» `PersistentGuCultivatorClone`
- ğŸ†• 6+1æ ¼ç•Œé¢ç³»ç»Ÿï¼ˆMenu + Screenï¼‰
- ğŸ†• å¬å”¤/å¬å›æœºåˆ¶ï¼ˆNBTå­˜å‚¨ + EntityDataAccessorï¼‰
- ğŸ†• å¢ç›Šç‰©å“ Registryï¼ˆä¿®æ”¹åˆ†èº«æ•°æ®ï¼‰
- ğŸ†• è›Šå¸ˆAIé€‚é…å™¨ï¼ˆæ•´åˆåç¼–è¯‘çš„AIé€»è¾‘ï¼‰

---

## ä¸‰ã€è¯¦ç»†æŠ€æœ¯å®ç°è·¯å¾„

### 3.1 ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒå®ä½“å¼€å‘ï¼ˆä¼˜å…ˆçº§ï¼šâ­â­â­â­â­ï¼‰

#### 3.1.1 åˆ›å»º `PersistentGuCultivatorClone` å®ä½“

**æ–‡ä»¶ä½ç½®**:
```
src/main/java/net/tigereye/chestcavity/compat/guzhenren/item/jian_dao/entity/PersistentGuCultivatorClone.java
```

**æ ¸å¿ƒåŠŸèƒ½**:
```java
public class PersistentGuCultivatorClone extends PathfinderMob {
    // ============ å®ä½“æ•°æ®åŒæ­¥ (EntityDataAccessor) ============
    private static final EntityDataAccessor<Optional<UUID>> OWNER = ...;
    private static final EntityDataAccessor<String> SKIN_TEXTURE = ...;
    private static final EntityDataAccessor<String> SKIN_MODEL = ...;
    private static final EntityDataAccessor<Integer> SKIN_COLOR = ...;

    // ============ å¢ƒç•Œæ•°æ® (é€šè¿‡ PersistentData) ============
    // è½¬æ•° (tier): 1-5
    // é˜¶æ®µ (stage): 1-4 (åˆ/ä¸­/é«˜/å·…)
    // ç”± GuCultivatorPersistentUtil.setTierAndStage() ç®¡ç†

    // ============ èµ„æºæ•°æ® (é€šè¿‡ GuzhenrenResourceBridge) ============
    // çœŸå…ƒ (zhenyuan)ã€æœ€å¤§çœŸå…ƒ (zuida_zhenyuan)
    // ç²¾åŠ› (jingli)ã€æœ€å¤§ç²¾åŠ› (zuida_jingli)
    // é­‚é­„ (hunpo)ã€æœ€å¤§é­‚é­„ (zuida_hunpo)

    // ============ èƒ¸è…”æ•°æ® (ChestCavitySnapshot) ============
    private CompoundTag chestCavityData; // å¤åˆ¶è‡ªç©å®¶

    // ============ 6+1æ ¼ç‰©å“æ  ============
    // ä½¿ç”¨ NeoForge ItemHandler èƒ½åŠ› (Capabilities.ItemHandler.ENTITY)
    // æ§½ä½ 0-5: è›Šè™« (ç”¨äºAIé‡Šæ”¾æŠ€èƒ½)
    // æ§½ä½ 6: å¢ç›Šç‰©å“ (ä¿®æ”¹åˆ†èº«æ•°æ®ï¼Œé€šè¿‡ Registry é…ç½®)
}
```

**å…³é”®æ–¹æ³•**:
1. **`spawn(ServerLevel, Player, CloneConfig)`**: é™æ€å·¥å‚æ–¹æ³•
   - è¯»å–ç©å®¶è½¬æ•°ï¼Œè®¡ç®—åˆ†èº«å¢ƒç•Œï¼ˆ`tier - 1`, æœ€ä½1è½¬1é˜¶æ®µï¼‰
   - å¤åˆ¶ç©å®¶çš®è‚¤ï¼ˆ`PlayerSkinUtil.SkinSnapshot`ï¼‰
   - å¤åˆ¶ç©å®¶èƒ¸è…”æ•°æ®ï¼ˆ`ChestCavitySnapshot.capture()`ï¼‰
   - åˆå§‹åŒ–èµ„æºä¸Šé™å¹¶é¡¶æ»¡ï¼ˆå‚è€ƒ `topOffGuResources()`ï¼‰
   - è°ƒç”¨ `finalizeSpawn()` è§¦å‘åŸç”Ÿåˆå§‹åŒ–

2. **`registerGoals()`**: æ³¨å†ŒAI Goals
   - å¤ç”¨ç°æœ‰çš„ `MeleeAttackGoal`ï¼ˆå¸¦ `GuSHiAi1Procedure.execute()` æ¡ä»¶ï¼‰
   - `NearestAttackableTargetGoal` æ”»å‡»æ•Œå¯¹ç”Ÿç‰©
   - å‚è€ƒ `NanGuXiuEntity` çš„ AI ç»“æ„

3. **`baseTick()`**: æ¯Tickæ›´æ–°
   - è°ƒç”¨è›Šå¸ˆAI Procedureï¼ˆå¦‚ `NanGuXiuZaiShiTiKeGengXinShiProcedure`ï¼‰
   - ç®¡ç†è›Šè™«å†·å´ï¼ˆ`è›Šè™«CD`, `è›Šè™«1CD`...`è›Šè™«5CD`, `æ€æ‹›CD`ï¼‰
   - å°è¯•é‡Šæ”¾è›Šè™«ï¼ˆä» ItemHandler æ§½ä½å– â†’ ä¸»æ‰‹ â†’ swing â†’ æ¸…ç©ºï¼‰

4. **`addAdditionalSaveData()` / `readAdditionalSaveData()`**:
   - ä¿å­˜/è¯»å–ï¼šæ‰€æœ‰è€…UUIDã€å¢ƒç•Œæ•°æ®ã€èµ„æºå€¼ã€èƒ¸è…”NBTã€çš®è‚¤æ•°æ®ã€ItemHandlerå†…å®¹

5. **`openInventoryMenu(ServerPlayer)`**:
   - æ‰“å¼€6+1æ ¼ç•Œé¢ï¼ˆMenuç³»ç»Ÿï¼‰

**æ½œåœ¨é™·é˜±**:
- âš ï¸ **AIé›†æˆå¤æ‚åº¦**: åç¼–è¯‘ä»£ç ä¸­çš„ `GuzhenrenModVariables.PlayerVariables` æ˜¯ Entity Attachmentï¼Œéœ€è¦ç¡®ä¿åˆ†èº«å®ä½“ä¹Ÿæ³¨å†Œäº†ç›¸åŒçš„æ•°æ®ç»“æ„
  - **è§£å†³æ–¹æ¡ˆ**: åœ¨ `finalizeSpawn()` æˆ–é¦–æ¬¡ `baseTick()` ä¸­åˆå§‹åŒ–æ‰€æœ‰å¿…éœ€çš„ PersistentData é”®
- âš ï¸ **èµ„æºåŒæ­¥**: çœŸå…ƒ/ç²¾åŠ›/é­‚é­„çš„å€¼éœ€è¦åœ¨å®¢æˆ·ç«¯åŒæ­¥æ˜¾ç¤ºï¼ˆå¦‚æœæœ‰UIéœ€æ±‚ï¼‰
  - **è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨ EntityDataAccessor æˆ–é€šè¿‡ Menu åŒæ­¥
- âš ï¸ **èƒ¸è…”æ•°æ®ä¸ç”Ÿæ•ˆ**: åˆ†èº«å®ä½“å¯èƒ½æ²¡æœ‰ `ChestCavityInstance` é™„ä»¶
  - **è§£å†³æ–¹æ¡ˆ**: ä»…å­˜å‚¨ NBTï¼Œä¸ä¾èµ–å®æ—¶çš„ ChestCavityInstanceï¼ˆKISSåŸåˆ™ï¼‰

---

### 3.2 ç¬¬äºŒé˜¶æ®µï¼š6+1æ ¼ç•Œé¢ç³»ç»Ÿï¼ˆä¼˜å…ˆçº§ï¼šâ­â­â­â­ï¼‰

#### 3.2.1 åˆ›å»º Menu ç±»

**æ–‡ä»¶ä½ç½®**:
```
src/main/java/net/tigereye/chestcavity/compat/guzhenren/item/jian_dao/ui/CloneInventoryMenu.java
```

**æ ¸å¿ƒåŠŸèƒ½**:
```java
public class CloneInventoryMenu extends AbstractContainerMenu {
    private final IItemHandlerModifiable cloneInventory; // 7æ§½ï¼š0-5è›Šè™«ï¼Œ6å¢ç›Š
    private final PersistentGuCultivatorClone cloneEntity;

    public CloneInventoryMenu(int containerId, Inventory playerInv, PersistentGuCultivatorClone clone) {
        super(CCContainers.CLONE_INVENTORY_MENU.get(), containerId);
        this.cloneEntity = clone;
        this.cloneInventory = clone.getCapability(Capabilities.ItemHandler.ENTITY, null);

        // å¸ƒå±€ï¼š
        // è¡Œ1: [è›Š1] [è›Š2] [è›Š3]
        // è¡Œ2: [è›Š4] [è›Š5] [è›Š6] [å¢ç›Š]
        // è¡Œ3+: ç©å®¶èƒŒåŒ…

        // è›Šè™«æ§½ä½ (0-5)
        for (int i = 0; i < 6; i++) {
            this.addSlot(new SlotItemHandler(cloneInventory, i, x, y) {
                @Override
                public boolean mayPlace(ItemStack stack) {
                    // ä»…å…è®¸è›Šè™«ç‰©å“ï¼ˆé€šè¿‡ Tag: guzhenren:guchongï¼‰
                    return stack.is(ItemTags.create(ResourceLocation.fromNamespaceAndPath("guzhenren", "guchong")));
                }
            });
        }

        // å¢ç›Šæ§½ä½ (6)
        this.addSlot(new SlotItemHandler(cloneInventory, 6, x, y) {
            @Override
            public boolean mayPlace(ItemStack stack) {
                // ä»…å…è®¸åœ¨ CloneBoostItemRegistry ä¸­æ³¨å†Œçš„ç‰©å“
                return CloneBoostItemRegistry.isBoostItem(stack.getItem());
            }

            @Override
            public void setChanged() {
                super.setChanged();
                // åº”ç”¨å¢ç›Šæ•ˆæœ
                applyBoostEffect(cloneEntity, getItem());
            }
        });

        // æ·»åŠ ç©å®¶èƒŒåŒ…æ§½ä½...
    }

    private void applyBoostEffect(PersistentGuCultivatorClone clone, ItemStack boostItem) {
        if (boostItem.isEmpty()) return;

        CloneBoostItemRegistry.getBoostEffect(boostItem.getItem()).ifPresent(effect -> {
            effect.apply(clone); // é€šè¿‡ Registry é…ç½®çš„æ•ˆæœ
        });
    }
}
```

**å…³é”®æŒ‘æˆ˜**:
- âš ï¸ **å·é“è›Šè™«æ‰£é™¤**: å½“æ§½ä½ä¸­çš„è›Šè™«è¢«å·é“è›Šç§»é™¤æ—¶ï¼Œéœ€è¦ç›‘å¬å¹¶åŒæ­¥
  - **è§£å†³æ–¹æ¡ˆ**: åœ¨ `ItemHandler` çš„ `setStackInSlot()` ä¸­æ·»åŠ å›è°ƒï¼Œé€šçŸ¥åˆ†èº«å®ä½“æ›´æ–°

#### 3.2.2 åˆ›å»º Screen ç±»ï¼ˆå®¢æˆ·ç«¯ï¼‰

**æ–‡ä»¶ä½ç½®**:
```
src/main/java/net/tigereye/chestcavity/compat/guzhenren/item/jian_dao/ui/CloneInventoryScreen.java
```

**æ ¸å¿ƒåŠŸèƒ½**:
- æ¸²æŸ“7ä¸ªæ§½ä½çš„GUIï¼ˆèƒŒæ™¯çº¹ç†ï¼‰
- æ˜¾ç¤ºåˆ†èº«å½“å‰å¢ƒç•Œã€èµ„æºçŠ¶æ€ï¼ˆå¯é€‰ï¼‰
- æ”¯æŒæ‹–æ‹½æ”¾ç½®/å–å‡ºç‰©å“

---

### 3.3 ç¬¬ä¸‰é˜¶æ®µï¼šå¢ç›Šç‰©å“Registryï¼ˆä¼˜å…ˆçº§ï¼šâ­â­â­ï¼‰

#### 3.3.1 åˆ›å»º Registry ç±»

**æ–‡ä»¶ä½ç½®**:
```
src/main/java/net/tigereye/chestcavity/compat/guzhenren/item/jian_dao/registry/CloneBoostItemRegistry.java
```

**æ ¸å¿ƒåŠŸèƒ½**:
```java
public final class CloneBoostItemRegistry {
    private static final Map<Item, ICloneBoostEffect> REGISTRY = new ConcurrentHashMap<>();

    /**
     * æ³¨å†Œå¢ç›Šç‰©å“
     * @param item ç‰©å“
     * @param effect æ•ˆæœï¼ˆä¿®æ”¹åˆ†èº«æ•°æ®çš„é€»è¾‘ï¼‰
     */
    public static void register(Item item, ICloneBoostEffect effect) {
        REGISTRY.put(item, effect);
    }

    public static boolean isBoostItem(Item item) {
        return REGISTRY.containsKey(item);
    }

    public static Optional<ICloneBoostEffect> getBoostEffect(Item item) {
        return Optional.ofNullable(REGISTRY.get(item));
    }

    // ============ ç¤ºä¾‹æ³¨å†Œï¼ˆåœ¨æ¨¡ç»„åˆå§‹åŒ–æ—¶è°ƒç”¨ï¼‰ ============
    public static void init() {
        // ç¤ºä¾‹ï¼šæ”¾å…¥é’»çŸ³ â†’ æå‡10%æœ€å¤§çœŸå…ƒ
        register(Items.DIAMOND, clone -> {
            var handle = GuzhenrenResourceBridge.open(clone);
            handle.ifPresent(h -> {
                h.getMaxZhenyuan().ifPresent(max -> {
                    h.setMaxZhenyuan(max * 1.1);
                });
            });
        });

        // ç¤ºä¾‹ï¼šæ”¾å…¥å‡‹é›¶éª·é«…å¤´ â†’ æå‡1ä¸ªé˜¶æ®µï¼ˆä¸è¶…è¿‡å·…å³°ï¼‰
        register(Items.WITHER_SKELETON_SKULL, clone -> {
            var tag = clone.getPersistentData();
            double stage = tag.getDouble("é‡å¤–è›Šå¸ˆé˜¶æ®µ");
            if (stage < 4) {
                GuCultivatorPersistentUtil.setTierAndStage(clone,
                    (int) tag.getDouble("é‡å¤–è›Šå¸ˆè½¬æ•°"),
                    (int) stage + 1);
            }
        });
    }
}

@FunctionalInterface
public interface ICloneBoostEffect {
    void apply(PersistentGuCultivatorClone clone);
}
```

**æ‰©å±•æ€§**:
- å¯é€šè¿‡ JSON é…ç½®æ–‡ä»¶åŠ¨æ€æ³¨å†Œï¼ˆæœªæ¥åŠŸèƒ½ï¼Œå½“å‰éµå¾ª YAGNIï¼‰
- æ”¯æŒè´Ÿé¢æ•ˆæœï¼ˆå¦‚æ”¾å…¥è…è‚‰ â†’ é™ä½10%èµ„æºï¼‰

---

### 3.4 ç¬¬å››é˜¶æ®µï¼šå¬å”¤/å¬å›æœºåˆ¶ï¼ˆä¼˜å…ˆçº§ï¼šâ­â­â­â­â­ï¼‰

#### 3.4.1 å¤šé‡å‰‘å½±è›Šç‰©å“å®ç°

**æ–‡ä»¶ä½ç½®**:
```
src/main/java/net/tigereye/chestcavity/compat/guzhenren/item/jian_dao/DuochongjianyingGuItem.java
```

**æ ¸å¿ƒåŠŸèƒ½**:
```java
public class DuochongjianyingGuItem extends Item {
    @Override
    public InteractionResultHolder<ItemStack> use(Level level, Player player, InteractionHand hand) {
        ItemStack stack = player.getItemInHand(hand);

        if (level.isClientSide) {
            return InteractionResultHolder.success(stack);
        }

        ServerLevel serverLevel = (ServerLevel) level;

        // æ£€æŸ¥æ˜¯å¦å·²æœ‰åˆ†èº«å­˜åœ¨ï¼ˆé€šè¿‡NBTå­˜å‚¨çš„UUIDï¼‰
        if (stack.hasTag() && stack.getTag().hasUUID("CloneUUID")) {
            UUID cloneUUID = stack.getTag().getUUID("CloneUUID");
            Entity entity = serverLevel.getEntity(cloneUUID);

            if (entity instanceof PersistentGuCultivatorClone clone && clone.isAlive()) {
                // ========== å¬å›åˆ†èº« ==========
                recallClone(stack, clone);
                player.displayClientMessage(Component.literal("Â§6åˆ†èº«å·²å¬å›"), true);
                return InteractionResultHolder.consume(stack);
            } else {
                // åˆ†èº«å·²æ­»äº¡æˆ–ä¸å­˜åœ¨ï¼Œæ¸…é™¤æ—§UUID
                stack.getTag().remove("CloneUUID");
            }
        }

        // ========== å¬å”¤åˆ†èº« ==========
        PersistentGuCultivatorClone clone = summonClone(serverLevel, player, stack);
        if (clone != null) {
            // ä¿å­˜åˆ†èº«UUIDåˆ°ç‰©å“NBT
            stack.getOrCreateTag().putUUID("CloneUUID", clone.getUUID());
            player.displayClientMessage(Component.literal("Â§aåˆ†èº«å·²å¬å”¤"), true);
            return InteractionResultHolder.consume(stack);
        }

        return InteractionResultHolder.fail(stack);
    }

    /**
     * å¬å”¤åˆ†èº«
     */
    private PersistentGuCultivatorClone summonClone(ServerLevel level, Player player, ItemStack stack) {
        // 1. è®¡ç®—åˆ†èº«å¢ƒç•Œï¼ˆç©å®¶è½¬æ•°-1ï¼Œæœ€ä½1è½¬1é˜¶æ®µï¼‰
        int playerTier = getPlayerTier(player);
        int cloneTier = Math.max(1, playerTier - 1);
        int cloneStage = 1; // åˆé˜¶ï¼ˆå¯é…ç½®ï¼‰

        // 2. åˆ›å»ºåˆ†èº«å®ä½“
        Vec3 spawnPos = player.position().add(player.getLookAngle().scale(2.0));
        PersistentGuCultivatorClone clone = PersistentGuCultivatorClone.spawn(
            level,
            player,
            spawnPos,
            cloneTier,
            cloneStage
        );

        if (clone == null) return null;

        // 3. å¦‚æœç‰©å“NBTä¸­æœ‰å­˜å‚¨çš„æ•°æ®ï¼ˆä¹‹å‰å¬å›çš„åˆ†èº«ï¼‰ï¼Œæ¢å¤å®ƒ
        if (stack.hasTag() && stack.getTag().contains("CloneData")) {
            CompoundTag cloneData = stack.getTag().getCompound("CloneData");
            clone.readAdditionalSaveData(cloneData);
        }

        return clone;
    }

    /**
     * å¬å›åˆ†èº«
     */
    private void recallClone(ItemStack stack, PersistentGuCultivatorClone clone) {
        // 1. ä¿å­˜åˆ†èº«æ•°æ®åˆ°ç‰©å“NBT
        CompoundTag cloneData = new CompoundTag();
        clone.addAdditionalSaveData(cloneData);
        stack.getOrCreateTag().put("CloneData", cloneData);

        // 2. ç§»é™¤åˆ†èº«å®ä½“
        clone.discard();

        // 3. æ’­æ”¾å¬å›ç‰¹æ•ˆå’ŒéŸ³æ•ˆ
        clone.level().playSound(null, clone.blockPosition(), SoundEvents.ENDERMAN_TELEPORT, SoundSource.PLAYERS, 1.0f, 1.2f);
    }

    @Override
    public InteractionResult useOn(UseOnContext context) {
        Player player = context.getPlayer();
        if (player == null || !player.isShiftKeyDown()) {
            return InteractionResult.PASS;
        }

        ItemStack stack = context.getItemInHand();

        // Shift + å³é”®æ–¹å— â†’ æ‰“å¼€åˆ†èº«ç•Œé¢ï¼ˆå¦‚æœåˆ†èº«å­˜åœ¨ï¼‰
        if (stack.hasTag() && stack.getTag().hasUUID("CloneUUID")) {
            UUID cloneUUID = stack.getTag().getUUID("CloneUUID");
            Entity entity = player.level().getEntity(cloneUUID);

            if (entity instanceof PersistentGuCultivatorClone clone && clone.isAlive()) {
                // æ‰“å¼€6+1æ ¼ç•Œé¢
                if (player instanceof ServerPlayer serverPlayer) {
                    clone.openInventoryMenu(serverPlayer);
                }
                return InteractionResult.SUCCESS;
            }
        }

        return InteractionResult.PASS;
    }
}
```

**å…³é”®æŠ€æœ¯ç‚¹**:
1. **æŒä¹…åŒ–å­˜å‚¨**: åˆ†èº«æ•°æ®å­˜å‚¨åœ¨ç‰©å“NBTä¸­ï¼ˆ`CloneData`å­—æ®µï¼‰
2. **UUIDè¿½è¸ª**: é€šè¿‡UUIDåœ¨ä¸–ç•Œä¸­æŸ¥æ‰¾åˆ†èº«å®ä½“
3. **è·¨ç»´åº¦é—®é¢˜**: å¦‚æœç©å®¶å’Œåˆ†èº«åœ¨ä¸åŒç»´åº¦ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†
   - **è§£å†³æ–¹æ¡ˆ**: åœ¨ `summonClone()` ä¸­æ£€æŸ¥ç»´åº¦ï¼Œå¿…è¦æ—¶ä¼ é€åˆ†èº«

**æ½œåœ¨é™·é˜±**:
- âš ï¸ **åˆ†èº«æ­»äº¡åç‰©å“çŠ¶æ€**: éœ€è¦ç›‘å¬åˆ†èº«æ­»äº¡äº‹ä»¶ï¼Œæ¸…é™¤ç‰©å“NBTä¸­çš„UUID
  - **è§£å†³æ–¹æ¡ˆ**: åœ¨ `PersistentGuCultivatorClone.die()` ä¸­æŸ¥æ‰¾æŒæœ‰è¯¥è›Šè™«çš„ç©å®¶å¹¶æ›´æ–°ç‰©å“

---

### 3.5 ç¬¬äº”é˜¶æ®µï¼šè›Šå¸ˆAIé€‚é…å™¨ï¼ˆä¼˜å…ˆçº§ï¼šâ­â­â­â­ï¼‰

#### 3.5.1 åˆ›å»ºAIé€‚é…å±‚

**æ–‡ä»¶ä½ç½®**:
```
src/main/java/net/tigereye/chestcavity/compat/guzhenren/item/jian_dao/ai/GuCultivatorAIAdapter.java
```

**æ ¸å¿ƒåŠŸèƒ½**:
```java
public final class GuCultivatorAIAdapter {
    /**
     * åˆå§‹åŒ–è›Šå¸ˆAIæ‰€éœ€çš„æ‰€æœ‰ PersistentData é”®
     */
    public static void initializeAIData(LivingEntity entity) {
        var tag = entity.getPersistentData();

        // è¿‘æˆ˜æ¨¡å¼æ ‡è®°
        if (!tag.contains("è¿‘æˆ˜")) {
            tag.putBoolean("è¿‘æˆ˜", false);
        }

        // è›Šè™«å†·å´
        tag.putDouble("è›Šè™«CD", 0.0);
        tag.putDouble("è›Šè™«1CD", 0.0);
        tag.putDouble("è›Šè™«2CD", 0.0);
        tag.putDouble("è›Šè™«3CD", 0.0);
        tag.putDouble("è›Šè™«4CD", 0.0);
        tag.putDouble("è›Šè™«5CD", 0.0);
        tag.putDouble("æ€æ‹›CD", 200.0); // åˆå§‹å»¶è¿Ÿ10ç§’
        tag.putDouble("æ²»ç–—è›Šè™«CD", 0.0);
    }

    /**
     * æ‰§è¡Œè›Šè™«é‡Šæ”¾é€»è¾‘ï¼ˆæ¯Tickè°ƒç”¨ï¼‰
     */
    public static void tickGuUsage(LivingEntity entity, IItemHandlerModifiable handler) {
        if (!(entity instanceof Mob mob)) return;
        LivingEntity target = mob.getTarget();
        if (target == null) return;

        var tag = entity.getPersistentData();

        // å†·å´é€’å‡ï¼ˆå‚è€ƒ NanGuXiuZaiShiTiKeGengXinShiProcedureï¼‰
        tag.putDouble("è›Šè™«CD", tag.getDouble("è›Šè™«CD") - 1.0);
        tag.putDouble("è›Šè™«1CD", tag.getDouble("è›Šè™«1CD") - 1.0);
        // ... å…¶ä»–å†·å´

        // å°è¯•é‡Šæ”¾è›Šè™«ï¼ˆå‚è€ƒ GuShiGuChong1Procedureï¼‰
        if (tag.getDouble("è›Šè™«CD") <= 0.0) {
            for (int slot = 0; slot <= 5; slot++) {
                String cdKey = slot == 0 ? "è›Šè™«CD" : "è›Šè™«" + slot + "CD";
                if (tag.getDouble(cdKey) <= 0.0) {
                    ItemStack guStack = handler.getStackInSlot(slot);
                    if (!guStack.isEmpty()) {
                        // æ”¾ä¸»æ‰‹ â†’ swing â†’ æ¸…ç©º
                        entity.setItemInHand(InteractionHand.MAIN_HAND, guStack.copy());
                        entity.swing(InteractionHand.MAIN_HAND, true);
                        entity.setItemInHand(InteractionHand.MAIN_HAND, ItemStack.EMPTY);

                        // è®¾ç½®å†·å´ï¼ˆç”±è›Šè™«ç‰©å“çš„é€»è¾‘å†³å®šå…·ä½“CDå€¼ï¼‰
                        tag.putDouble(cdKey, 100.0); // é»˜è®¤5ç§’CD
                        tag.putDouble("è›Šè™«CD", 20.0); // å…¨å±€1ç§’CD
                        break;
                    }
                }
            }
        }
    }
}
```

**é›†æˆåˆ° `PersistentGuCultivatorClone`**:
```java
@Override
public void baseTick() {
    super.baseTick();

    if (!this.level().isClientSide) {
        // åˆå§‹åŒ–AIæ•°æ®ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
        if (!getPersistentData().contains("ai_initialized")) {
            GuCultivatorAIAdapter.initializeAIData(this);
            getPersistentData().putBoolean("ai_initialized", true);
        }

        // æ¯Tickæ‰§è¡Œè›Šè™«é‡Šæ”¾é€»è¾‘
        Object cap = this.getCapability(Capabilities.ItemHandler.ENTITY, null);
        if (cap instanceof IItemHandlerModifiable handler) {
            GuCultivatorAIAdapter.tickGuUsage(this, handler);
        }
    }
}
```

---

### 3.6 ç¬¬å…­é˜¶æ®µï¼šå¢ƒç•Œè®¡ç®—ä¸èµ„æºé•œåƒï¼ˆä¼˜å…ˆçº§ï¼šâ­â­â­â­ï¼‰

#### 3.6.1 å¢ƒç•Œè®¡ç®—é€»è¾‘

**åœ¨ `PersistentGuCultivatorClone.spawn()` ä¸­**:
```java
public static PersistentGuCultivatorClone spawn(
    ServerLevel level,
    Player owner,
    Vec3 position,
    int overrideTier,  // å¦‚æœ > 0 åˆ™ä½¿ç”¨è¯¥å€¼ï¼Œå¦åˆ™è‡ªåŠ¨è®¡ç®—
    int overrideStage
) {
    // è¯»å–ç©å®¶è½¬æ•°
    int playerTier = 1;
    try {
        var handle = GuzhenrenResourceBridge.open(owner);
        if (handle.isPresent()) {
            playerTier = (int) Math.round(handle.get().getZhuanshu().orElse(1.0));
        }
    } catch (Exception e) {
        // ä½¿ç”¨é»˜è®¤å€¼
    }

    // è®¡ç®—åˆ†èº«è½¬æ•°ï¼šç©å®¶è½¬æ•° - 1ï¼ˆæœ€ä½1è½¬ï¼‰
    int cloneTier = overrideTier > 0 ? overrideTier : Math.max(1, playerTier - 1);
    int cloneStage = overrideStage > 0 ? overrideStage : 1; // é»˜è®¤åˆé˜¶

    PersistentGuCultivatorClone clone = CCEntities.PERSISTENT_GU_CULTIVATOR_CLONE.get().create(level);
    if (clone == null) return null;

    clone.moveTo(position.x, position.y, position.z, owner.getYRot(), 0.0f);
    clone.setOwner(owner);
    clone.setSkin(PlayerSkinUtil.SkinSnapshot.from(owner));

    // è®¾ç½®å¢ƒç•Œ
    GuCultivatorPersistentUtil.setTierAndStage(clone, cloneTier, cloneStage);

    // å¤åˆ¶èƒ¸è…”æ•°æ®
    ChestCavitySnapshot snapshot = new ChestCavitySnapshot();
    snapshot.capture((ServerPlayer) owner);
    CompoundTag chestData = snapshot.save(level.registryAccess());
    clone.setChestCavityData(chestData);

    // åˆå§‹åŒ–èµ„æºï¼ˆåŸºäºè½¬æ•°ï¼‰
    initializeResources(clone, cloneTier, cloneStage);

    level.addFreshEntity(clone);
    return clone;
}

/**
 * åˆå§‹åŒ–èµ„æºä¸Šé™å¹¶é¡¶æ»¡
 */
private static void initializeResources(PersistentGuCultivatorClone clone, int tier, int stage) {
    try {
        var handle = GuzhenrenResourceBridge.open(clone);
        if (handle.isEmpty()) return;

        var h = handle.get();

        // æ ¹æ®è½¬æ•°è®¾ç½®èµ„æºä¸Šé™ï¼ˆå‚è€ƒè›ŠçœŸäººæ¨¡ç»„çš„è§„åˆ™ï¼‰
        double zhenyuanMax = tier * 200.0; // 1è½¬=200, 2è½¬=400...
        double jingliMax = tier * 100.0;
        double hunpoMax = tier * 50.0;

        h.setMaxZhenyuan(zhenyuanMax);
        h.setZhenyuan(zhenyuanMax); // é¡¶æ»¡

        h.setMaxJingli(jingliMax);
        h.setJingli(jingliMax);

        h.writeDouble("zuida_hunpo", hunpoMax);
        h.writeDouble("hunpo", hunpoMax);

    } catch (Exception e) {
        // é™é»˜å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤å€¼
    }
}
```

---

## å››ã€é¡¹ç›®ç»“æ„è§„åˆ’

```
src/main/java/net/tigereye/chestcavity/compat/guzhenren/item/jian_dao/
â”œâ”€â”€ entity/
â”‚   â”œâ”€â”€ SwordShadowClone.java                   (å·²æœ‰ï¼Œä¸´æ—¶åˆ†èº«)
â”‚   â””â”€â”€ PersistentGuCultivatorClone.java        (ğŸ†• æŒä¹…åŒ–åˆ†èº«)
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ CloneInventoryMenu.java                 (ğŸ†• Menuå®¹å™¨)
â”‚   â””â”€â”€ CloneInventoryScreen.java               (ğŸ†• å®¢æˆ·ç«¯ç•Œé¢)
â”œâ”€â”€ registry/
â”‚   â””â”€â”€ CloneBoostItemRegistry.java             (ğŸ†• å¢ç›Šç‰©å“æ³¨å†Œ)
â”œâ”€â”€ ai/
â”‚   â””â”€â”€ GuCultivatorAIAdapter.java              (ğŸ†• è›Šå¸ˆAIé€‚é…å™¨)
â”œâ”€â”€ behavior/organ/
â”‚   â””â”€â”€ DuochongjianyingGuOrganBehavior.java    (ğŸ†• å¤šé‡å‰‘å½±è›Šå™¨å®˜è¡Œä¸º)
â””â”€â”€ å¤šé‡å‰‘å½±è›Š_å®Œæ•´å®ç°è®¡åˆ’.md                   (æœ¬æ–‡æ¡£)
```

**æ³¨å†Œç±»ä¿®æ”¹**:
- `CCEntities.java`: æ³¨å†Œ `PERSISTENT_GU_CULTIVATOR_CLONE`
- `CCContainers.java`: æ³¨å†Œ `CLONE_INVENTORY_MENU`
- `CCItems.java`: æ³¨å†Œå¤šé‡å‰‘å½±è›Šç‰©å“
- `JiandaoOrganRegistry.java`: æ³¨å†Œå™¨å®˜è¡Œä¸º

---

## äº”ã€æ½œåœ¨é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ

### 5.1 è›Šå¸ˆAIé›†æˆå¤æ‚æ€§
**é—®é¢˜**: åç¼–è¯‘ä»£ç ä¾èµ– `GuzhenrenModVariables.PlayerVariables` Entity Attachment
**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿åˆ†èº«å®ä½“åœ¨ `finalizeSpawn()` æ—¶æ³¨å†Œç›¸åŒçš„ Attachment
2. æˆ–è€…é€šè¿‡ `PersistentData` æ‰‹åŠ¨åˆå§‹åŒ–æ‰€æœ‰å¿…éœ€çš„é”®ï¼ˆæ¨èï¼ŒKISSåŸåˆ™ï¼‰

### 5.2 è·¨ç»´åº¦åˆ†èº«ç®¡ç†
**é—®é¢˜**: ç©å®¶åœ¨ä¸»ä¸–ç•Œï¼Œåˆ†èº«åœ¨ä¸‹ç•Œï¼Œå¬å›æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ
**è§£å†³æ–¹æ¡ˆ**:
1. åœ¨ `recallClone()` å‰æ£€æŸ¥ç»´åº¦ï¼Œå¿…è¦æ—¶ä¼ é€åˆ†èº«åˆ°ç©å®¶ç»´åº¦
2. æˆ–é™åˆ¶å¬å”¤/å¬å›ä»…åœ¨åŒç»´åº¦æœ‰æ•ˆï¼ˆé…ç½®é€‰é¡¹ï¼‰

### 5.3 åˆ†èº«æ­»äº¡åç‰©å“çŠ¶æ€
**é—®é¢˜**: åˆ†èº«æ­»äº¡åï¼Œç‰©å“NBTä¸­çš„UUIDä»å­˜åœ¨ï¼Œå¯¼è‡´æ— æ³•é‡æ–°å¬å”¤
**è§£å†³æ–¹æ¡ˆ**:
åœ¨ `PersistentGuCultivatorClone.die()` ä¸­æ·»åŠ ï¼š
```java
@Override
public void die(DamageSource source) {
    super.die(source);

    // æŸ¥æ‰¾æŒæœ‰è¯¥è›Šè™«çš„ç©å®¶å¹¶æ¸…é™¤UUID
    LivingEntity owner = getOwnerEntity();
    if (owner instanceof Player player) {
        // éå†ç©å®¶èƒŒåŒ…ï¼Œæ‰¾åˆ°å­˜å‚¨è¯¥åˆ†èº«UUIDçš„ç‰©å“
        for (ItemStack stack : player.getInventory().items) {
            if (stack.hasTag() && stack.getTag().hasUUID("CloneUUID")) {
                UUID storedUUID = stack.getTag().getUUID("CloneUUID");
                if (storedUUID.equals(this.getUUID())) {
                    stack.getTag().remove("CloneUUID");
                    stack.getTag().remove("CloneData");
                    player.displayClientMessage(Component.literal("Â§cåˆ†èº«å·²é˜µäº¡"), true);
                    break;
                }
            }
        }
    }
}
```

### 5.4 ItemHandlerèƒ½åŠ›æœªæ³¨å†Œ
**é—®é¢˜**: åˆ†èº«å®ä½“æ²¡æœ‰ `Capabilities.ItemHandler.ENTITY` èƒ½åŠ›
**è§£å†³æ–¹æ¡ˆ**:
åœ¨å®ä½“ç±»ä¸­æ·»åŠ èƒ½åŠ›æä¾›å™¨ï¼š
```java
@Override
public <T> LazyOptional<T> getCapability(Capability<T> cap, @Nullable Direction side) {
    if (cap == Capabilities.ItemHandler.ENTITY) {
        return LazyOptional.of(() -> this.inventory).cast();
    }
    return super.getCapability(cap, side);
}

private final IItemHandlerModifiable inventory = new ItemStackHandler(7) {
    @Override
    protected void onContentsChanged(int slot) {
        // æ§½ä½å˜åŒ–æ—¶çš„å›è°ƒï¼ˆå¦‚å·é“è›Šè™«å·èµ°ï¼‰
        PersistentGuCultivatorClone.this.onInventoryChanged(slot);
    }
};
```

### 5.5 æœåŠ¡ç«¯/å®¢æˆ·ç«¯åŒæ­¥
**é—®é¢˜**: çš®è‚¤ã€NBTæ•°æ®åœ¨å®¢æˆ·ç«¯ä¸å¯è§
**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨ `EntityDataAccessor` åŒæ­¥å…³é”®æ•°æ®ï¼ˆçš®è‚¤çº¹ç†ã€é¢œè‰²ï¼‰
- MenuåŒæ­¥é€šè¿‡ `ContainerData` æˆ–è‡ªå®šä¹‰ç½‘ç»œåŒ…

---

## å…­ã€æµ‹è¯•è®¡åˆ’

### 6.1 å•å…ƒæµ‹è¯•
1. **å¢ƒç•Œè®¡ç®—**:
   - ç©å®¶1è½¬ â†’ åˆ†èº«1è½¬ï¼ˆè¾¹ç•Œï¼‰
   - ç©å®¶3è½¬ â†’ åˆ†èº«2è½¬
   - ç©å®¶5è½¬ â†’ åˆ†èº«4è½¬

2. **èµ„æºåˆå§‹åŒ–**:
   - éªŒè¯èµ„æºä¸Šé™æ­£ç¡®
   - éªŒè¯èµ„æºå·²é¡¶æ»¡

3. **ç‰©å“NBTåºåˆ—åŒ–**:
   - å¬å”¤ â†’ å¬å› â†’ å†å¬å”¤ï¼Œæ•°æ®æ˜¯å¦ä¿ç•™

### 6.2 é›†æˆæµ‹è¯•
1. **AIè¡Œä¸º**:
   - åˆ†èº«æ˜¯å¦æ­£ç¡®æ”»å‡»æ•Œå¯¹ç”Ÿç‰©
   - åˆ†èº«æ˜¯å¦é‡Šæ”¾è›Šè™«æŠ€èƒ½
   - å†·å´æœºåˆ¶æ˜¯å¦æ­£å¸¸

2. **ç•Œé¢äº¤äº’**:
   - æ”¾å…¥/å–å‡ºè›Šè™«
   - å¢ç›Šç‰©å“æ˜¯å¦ç”Ÿæ•ˆ
   - å·é“è›Šè™«æ˜¯å¦æ­£ç¡®æ‰£é™¤

3. **è¾¹ç•Œæƒ…å†µ**:
   - åˆ†èº«æ­»äº¡åé‡æ–°å¬å”¤
   - ç©å®¶ç¦»çº¿å†ä¸Šçº¿ï¼Œåˆ†èº«çŠ¶æ€
   - è·¨ç»´åº¦å¬å”¤/å¬å›

---

## ä¸ƒã€ä¼˜å…ˆçº§ä¸è¿­ä»£è®¡åˆ’

### ç¬¬ä¸€è¿­ä»£ï¼ˆMVPï¼‰
1. âœ… åˆ›å»º `PersistentGuCultivatorClone` å®ä½“ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰
2. âœ… å®ç°å¬å”¤/å¬å›æœºåˆ¶ï¼ˆæ— ç•Œé¢ï¼‰
3. âœ… å¢ƒç•Œè®¡ç®—ä¸èµ„æºåˆå§‹åŒ–
4. âœ… åŸºæœ¬AIï¼ˆè¿‘æˆ˜æ”»å‡»ï¼Œæ— è›Šè™«é‡Šæ”¾ï¼‰

### ç¬¬äºŒè¿­ä»£
1. âœ… 6+1æ ¼ç•Œé¢ç³»ç»Ÿï¼ˆMenu + Screenï¼‰
2. âœ… å¢ç›Šç‰©å“Registry
3. âœ… è›Šå¸ˆAIé€‚é…å™¨ï¼ˆè›Šè™«é‡Šæ”¾ï¼‰

### ç¬¬ä¸‰è¿­ä»£
1. âœ… èƒ¸è…”æ•°æ®å¤åˆ¶
2. âœ… å·é“è›Šè™«æ‰£é™¤æœºåˆ¶
3. âœ… è·¨ç»´åº¦æ”¯æŒ
4. âœ… çš®è‚¤åŒæ­¥ä¼˜åŒ–

---

## å…«ã€æ³¨æ„äº‹é¡¹

1. **ä»£ç è§„èŒƒ**:
   - æ‰€æœ‰æ³¨é‡Šä½¿ç”¨ä¸­æ–‡
   - éµå¾ªç°æœ‰ä»£ç é£æ ¼
   - ä½¿ç”¨ `LOGGER.debug/warn/error` è®°å½•å…³é”®ä¿¡æ¯

2. **æ€§èƒ½è€ƒè™‘**:
   - é¿å…åœ¨ `baseTick()` ä¸­è¿›è¡Œæ˜‚è´µæ“ä½œ
   - ä½¿ç”¨ `LazyOptional` ç¼“å­˜èƒ½åŠ›
   - ItemHandleræ“ä½œå°½é‡æ‰¹é‡åŒ–

3. **å‘åå…¼å®¹**:
   - ç‰©å“NBTç»“æ„å˜åŒ–æ—¶æä¾›è¿ç§»é€»è¾‘
   - æ—§ç‰ˆæœ¬å¬å”¤çš„åˆ†èº«åº”èƒ½æ­£å¸¸å·¥ä½œ

---

## ä¹ã€åç»­æ‰©å±•æ–¹å‘

1. **å¤šåˆ†èº«æ”¯æŒ**: å…è®¸åŒæ—¶å¬å”¤å¤šä¸ªåˆ†èº«ï¼ˆé…ç½®ä¸Šé™ï¼‰
2. **åˆ†èº«æŒ‡ä»¤ç³»ç»Ÿ**: `/clone follow`, `/clone attack`, `/clone stay`
3. **åˆ†èº«æŠ€èƒ½æ ‘**: é€šè¿‡é“ç—•è§£é”ç‰¹æ®Šèƒ½åŠ›
4. **åˆ†èº«è½¬ç”Ÿ**: æ­»äº¡åä¿ç•™ç»éªŒï¼Œé‡æ–°å¬å”¤æ—¶ç»§æ‰¿
5. **åˆ†èº«å¤–è§‚å®šåˆ¶**: é€šè¿‡ç‰©å“æ”¹å˜åˆ†èº«çš®è‚¤/æ¨¡å‹

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2025-11-14
**ä½œè€…**: AI Assistant + Kizunad
