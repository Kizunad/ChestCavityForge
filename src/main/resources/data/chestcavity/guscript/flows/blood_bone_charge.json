{
  "initial_state": "idle",
  "states": {
    "idle": {
      "transitions": [
        {
          "trigger": "start",
          "target": "charging",
          "guards": [
            { "type": "cooldown", "key": "chestcavity:blood_bone_charge" },
            { "type": "resource", "identifier": "zhenyuan", "minimum": 10.0 }
          ],
          "actions": [
            { "type": "consume_resource", "identifier": "zhenyuan", "amount": 10.0 },
            { "type": "set_cooldown", "key": "chestcavity:blood_bone_charge", "ticks": 200 }
          ]
        }
      ]
    },
    "charging": {
      "enter_fx": [ "chestcavity:blood_bone_charge_start" ],
      "enter_actions": [
        {
          "type": "apply_attribute",
          "attribute": "minecraft:generic.movement_speed",
          "modifier": "chestcavity:charge_lock",
          "operation": "MULTIPLY_TOTAL",
          "amount": -1.0
        }
      ],
      "update_period": 20,
      "update_actions": [
        { "type": "consume_health", "amount": 2.0 },
        { "type": "consume_resource", "identifier": "zhenyuan", "amount": 200.0 },
        { "type": "consume_resource", "identifier": "jingli", "amount": 10.0 },
        {
          "type": "trigger_actions",
          "actions": [
            { "id": "emit.fx", "fxId": "chestcavity:blood_bone_charge_heartbeat", "intensity": 1.0 }
          ]
        },
        {
          "type": "trigger_actions",
          "actions": [
            { "id": "emit.fx", "fxId": "chestcavity:blood_bone_charge_tick", "intensity": 1.0 }
          ]
        }
      ],
      "transitions": [
        {
          "trigger": "auto",
          "target": "cancel",
          "guards": [
            { "type": "health_below", "maximum": 2.0 }
          ]
        },
        {
          "trigger": "auto",
          "target": "cancel",
          "guards": [
            { "type": "resource_below", "identifier": "zhenyuan", "maximum": 20.0 }
          ]
        },
        {
          "trigger": "auto",
          "target": "cancel",
          "guards": [
            { "type": "resource_below", "identifier": "jingli", "maximum": 10.0 }
          ]
        },
        { "trigger": "auto", "target": "charged", "min_ticks": 40 },
        { "trigger": "cancel", "target": "cancel" }
      ]
    },
    "charged": {
      "update_period": 20,
      "update_actions": [
        { "type": "consume_health", "amount": 2.0 },
        { "type": "consume_resource", "identifier": "zhenyuan", "amount": 20.0 },
        { "type": "consume_resource", "identifier": "jingli", "amount": 10.0 },
        {
          "type": "trigger_actions",
          "actions": [
            { "id": "emit.fx", "fxId": "chestcavity:blood_bone_charge_heartbeat", "intensity": 1.0 }
          ]
        },
        {
          "type": "trigger_actions",
          "actions": [
            { "id": "emit.fx", "fxId": "chestcavity:blood_bone_charge_tick", "intensity": 1.0 }
          ]
        }
      ],
      "transitions": [
        {
          "trigger": "auto",
          "target": "cancel",
          "guards": [
            { "type": "health_below", "maximum": 2.0 }
          ]
        },
        {
          "trigger": "auto",
          "target": "cancel",
          "guards": [
            { "type": "resource_below", "identifier": "zhenyuan", "maximum": 20.0 }
          ]
        },
        {
          "trigger": "auto",
          "target": "cancel",
          "guards": [
            { "type": "resource_below", "identifier": "jingli", "maximum": 10.0 }
          ]
        },
        { "trigger": "auto", "target": "releasing", "min_ticks": 160 },
        { "trigger": "cancel", "target": "cancel" }
      ]
    },
    "releasing": {
      "enter_fx": [ "chestcavity:burst" ],
      "enter_actions": [
        {
          "type": "trigger_actions",
          "actions": [
            { "id": "emit.blood_bone_bomb", "base": 100.0 }
          ]
        }
      ],
      "transitions": [
        { "trigger": "auto", "target": "cooldown", "min_ticks": 5 }
      ]
    },
    "cooldown": {
      "enter_actions": [
        {
          "type": "remove_attribute",
          "attribute": "minecraft:generic.movement_speed",
          "modifier": "chestcavity:charge_lock"
        }
      ],
      "transitions": [
        { "trigger": "auto", "target": "idle", "min_ticks": 40 }
      ]
    },
    "cancel": {
      "enter_actions": [
        {
          "type": "remove_attribute",
          "attribute": "minecraft:generic.movement_speed",
          "modifier": "chestcavity:charge_lock"
        },
        { "type": "true_damage", "amount": 50.0 },
        { "type": "explode", "power": 4.0 },
        {
          "type": "trigger_actions",
          "actions": [
            { "id": "emit.fx", "fxId": "chestcavity:blood_bone_charge_failure", "intensity": 1.0 }
          ]
        }
      ],
      "transitions": [
        { "trigger": "auto", "target": "cooldown", "min_ticks": 5 }
      ]
    }
  }
}
